
<div class="custom-note-form">
  <div class="note-and-tag">
    <div class="create-note">
      <h2>Create New Note</h2>
      <form (ngSubmit)="createNote()">
        <label>Title:</label>
        <input type="text" [(ngModel)]="newNote.title" name="title" required #titleInput="ngModel"><br><br>
        <label>Content:</label>
        <textarea [(ngModel)]="newNote.content" name="content" required></textarea><br><br>
        <button type="submit" [style.background]="titleInput.valid ? '#007bff' : 'grey'" [disabled]="!titleInput.valid || titleInput.pristine">Create Note</button>
      </form>
    </div>

  </div>
<hr>

<div *ngIf="notes.length > 0">
  <h2>Existing Notes</h2>
  <ul>
    <li *ngFor="let note of notes">
      <div *ngIf="editingNoteId !== note.id; else editMode">
        <strong>{{ note.title }}</strong> - {{ note.content }}
        <p>Tags:
          <span *ngFor="let tag of note.tags">
          <span *ngIf="tag">{{ tag.name }}</span>
         </span>
        </p>

        <button (click)="startEditing(note.id)">Edit</button>
        <button (click)="deleteNote(note.id)">Delete</button>
      </div>
      <ng-template #editMode>
        <form (submit)="updateNote(note.id, updatedNote)">
          <label for="editTitle">Title:</label>
          <input type="text" id="editTitle" [(ngModel)]="updatedNote.title" name="title" required>

          <label for="editContent">Content:</label>
          <textarea id="editContent" [(ngModel)]="updatedNote.content" name="content" required></textarea>

          <div class="tag-section">
            <h3>Available Tags</h3>
            <select [(ngModel)]="selectedTagId" [ngModelOptions]="{ standalone: true }">
              <option *ngFor="let tag of availableTags" [value]="tag.id">{{ tag.name }}</option>
            </select>
            <button type="button" (click)="assignTag(selectedTagId); cancelEditing()">Assign Tag</button>
            <button type="button" (click)="unassignTag(selectedTagId); cancelEditing()">Unassign Tag</button>
          </div>

          <div class="button-group">
            <button type="submit">Save</button>
            <button type="button" (click)="cancelEditing()">Cancel</button>
          </div>
        </form>
      </ng-template>
    </li>
  </ul>
</div>

<div *ngIf="notes.length === 0">
  <p>No notes available.</p>
</div>

</div>
